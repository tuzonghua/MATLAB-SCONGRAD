%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%										%%
%%  Extended Powell 					%%
%%  Initial Point: x0 = [3;-1;0;1;...]  %%
%%										%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [f,g] = scongrad_func1(x)

n = length(x);
g = zeros(n,1);

		f = 0;		
		j = 1;
		
		for i=1:n/4  
		
			t1 = x(4*i-3) + 10*x(4*i-2); 
			t2 = x(4*i-1) - x(4*i);
			t3 = x(4*i-2) - 2*x(4*i-1);
			t4 = x(4*i-3) - x(4*i);     
			
			f = f + t1*t1 + 5*t2*t2 + t3.^4 + 10*t4.^4;      
			       
			g(j)   =   2*t1 + 40*t4.^3;
			g(j+1) =  20*t1 +  4*t3.^3;
			g(j+2) =  10*t2 -  8*t3.^3;
			g(j+3) = -10*t2 - 40*t4.^3;
			
			j = j+4;  
			
		end   

end